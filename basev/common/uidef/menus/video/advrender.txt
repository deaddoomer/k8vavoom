// advanced video options menu
menudef AdvRenderOptions {
  Title = "ADVANCED RENDER OPTIONS";

  header "Options for broken OpenGL drivers";

  option bool {
    title = "Z-Fighting Prevention";
    cvar = r_shadowvol_use_pofs;
    help =
      "This option should prevent z-fighting with shadow volumes."
      "But with some OpenGL drivers it breaks shadow volumes completely."
      "If you set renderer to Shadow Volumes, and suddenly the lighting"
      "is glitchy, try to turn this 'OFF'";
  }


  header "Render Portals Options";

  option bool {
    title = "Allow cameras";
    cvar = r_allow_cameras;
    help = "Allow rendering live cameras?";
  }

  option bool {
    title = "Allow horizons";
    cvar = r_allow_horizons;
    help =
      "Allow rendering horizon portals?"
      "\cGPlease note that you have to restart/reload the map after changing this,"
      "\cGor visual glitches will occur.";
  }

  option bool {
    title = "Allow mirrors";
    cvar = r_allow_mirrors;
    help =
      "Allow rendering mirror portals?"
      "Note that portal rendering in k8vavoom is somewhat slow."
      "\cGPlease note that you have to restart/reload the map after changing this,"
      "\cGor visual glitches will occur.";
  }

  option bool /*[__k8vavoom_developer_version > 0]*/ {
    title = "Allow stacked sectors";
    cvar = r_allow_stacked_sectors;
    help =
      "Allow rendering stacked sectors via portals?"
      "Currently this is *VERY* glitchy, so you'd better don't turn this on."
      "\cGPlease note that you have to restart/reload map after changing this,"
      "\cGor visual glitches will occur.";
  }

  option numeric {
    title = "Maximum mirror count";
    cvar = r_maxmiror_depth;
    step = 1;
    min = 0;
    max = 6;
    help =
      "Maximum allowed mirrors per frame."
      "Usually has little effect.";
  }

  option numeric [__k8vavoom_developer_version > 0] {
    title = "Maximum portal depth";
    cvar = r_max_portal_depth;
    step = 1;
    min = -1;
    max = 16;
    help =
      "Maximum allowed portal depth."
      "Usually has huge effect on maps with mirrors."
      "If you suddenly see FPS below 30 in some map places,"
      "this is probably due to portals. Try to decrease this, or"
      "turn mirrors off, or turn this off."
      "-1 means 'infinite portal depth'.";
  }


  header "Stencil Shadows Options";

  option bool {
    title = "Allow Static Lighting";
    cvar = r_static_lights;
    help = "Process static lights?";
  }

  option numeric {
    title = "Maximum Lights";
    cvar = r_max_lights;
    step = 1;
    min = -1;
    max = 256;
    help =
      "Maximum allowed light sources (-1 means unlimited)."
      "This is hard limit for light sources in one frame.";
  }

  option numeric {
    title = "Maximum Total Lit Subsectors";
    cvar = r_max_light_segs_all;
    step = 1;
    min = -1;
    max = 1024;
    help =
      "Maximum allowed lit surfaces (-1 means unlimited)."
      "This limits total number of rendered light surfaces."
      "There is little reason to limit this, as it is usually"
      "has very low performance hit.";
  }

  option numeric {
    title = "Maximum Single Lit Subsectors";
    cvar = r_max_light_segs_one;
    step = 1;
    min = -1;
    max = 1024;
    help =
      "Maximum allowed lit surfaces for one light (-1 means unlimited)."
      "This limits number of rendered light surfaces per one light."
      "There is little reason to limit this, as it is usually"
      "has very low performance hit.";
  }

  option numeric {
    title = "Maximum Total Shadow Volumes";
    cvar = r_max_shadow_segs_all;
    step = 1;
    min = -1;
    max = 1024;
    help =
      "Maximum allowed shadow volumes (-1 means unlimited)."
      "This limits total number of rendered shadow volumes."
      "This is what causes most slowdowns. Decrease this to"
      "make rendering faster (but with less proper shadows)."
      "Note that nearby static lights are rendered first,"
      "so even with low numbers this will look reasonably good.";
  }

  option numeric {
    title = "Maximum Single Shadow Volumes";
    cvar = r_max_shadow_segs_one;
    step = 1;
    min = -1;
    max = 1024;
    help =
      "Maximum allowed shadow volumes for one light (-1 means unlimited)."
      "There is little reason to change this.";
  }

  option bool {
    title = "Shadow Check";
    cvar = r_advlight_opt_trace;
    help =
      "Check if dynamic light can cast shadow."
      "This can speedup rendering (lightmapped too),"
      "so better leave this 'ON'.";
  }

  option bool {
    title = "Use Scissoring";
    cvar = r_advlight_opt_scissor;
    help =
      "Limit light screen update area by light box projection."
      "There is no reason to turn this off, ever. But if you"
      "want to enjoy a slideshow, you can do it.";
  }

  option bool {
    title = "Optimise scissor";
    cvar = r_advlight_opt_optimise_scissor;
    help =
      "Optimise light scissor with actual geometry."
      "If lit geometry bounds is less than the actual light scissor,"
      "there is no need to render anything outside of it.";
  }

  option bool {
    title = "Use Depth Bounding";
    cvar = gl_enable_depth_bounds;
    help =
      "Limit z by the actual light radius, if your GPU can do it."
      "This can buy you some FPS by reducing fill rate.";
  }

  option bool {
    title = "Smarter Stencil Clearing";
    cvar = gl_smart_dirty_rects;
    help =
      "Use dirty rectangles to decide if we should clear stencil buffer."
      "This can skip some GPU clear calls, but I'm not sure if it worth it.";
  }


  header "Shadow Casting Optimisations";

  option bool {
    title = "Skip Non-Shadow Surfaces";
    cvar = gl_smart_reject_shadow_surfaces;
    help =
      "Skip some surfaces that cannot possibly cast shadow."
      "This can buy you some FPS with huge lights, but I'm not sure"
      "if i wrote the algo right, so you can turn this off if you'll"
      "see some invalid shadowing.";
  }

  option bool {
    title = "Skip Non-Shadow Segs";
    cvar = gl_smart_reject_shadow_segs;
    help =
      "Skip some segs that cannot possibly cast shadow."
      "Suboption of common skipping.";
  }

  option bool {
    title = "Skip Non-Shadow Flats";
    cvar = gl_smart_reject_shadow_flats;
    help =
      "Skip some flats that cannot possibly cast shadow."
      "Suboption of common skipping.";
  }


  header "DEBUG Stencil Shadows Options";

  option bool {
    title = "Use quad-clear for stencil";
    cvar = gl_use_stencil_quad_clear;
    help =
      "Clear stencil buffer with rendered quad instead of 'glClear()'?"
      "On most (if not all) GPUS it is faster to use 'glClear()`,"
      "but you can check if this will give you any speedup.";
  }

  option bool {
    title = "Render Surface Textures";
    textColor = BRICK;
    cvar = gl_dbg_adv_render_surface_textures;
    help = "Turn this off to see ambient lighting without textures.";
  }

  option bool {
    title = "Render Surface Fog";
    textColor = BRICK;
    cvar = gl_dbg_adv_render_surface_fog;
    help = "Turn this off to disable fog/light darkening.";
  }
}
