CXX=@CXX@
CXXFLAGS=@CXXFLAGS@
EXEEXT=@EXEEXT@
LIB_STDCXX=@LIB_STDCXX@
OBJEXT=@OBJEXT@

LIBS=$(LIB_STDCXX)
CXXFLAGS += -Wall

OBJS = \
	cmdlib.$(OBJEXT) \
	constexp.$(OBJEXT) \
	error.$(OBJEXT) \
	expressn.$(OBJEXT) \
	info.$(OBJEXT) \
	modifiers.$(OBJEXT) \
	name.$(OBJEXT) \
	parse.$(OBJEXT) \
	parse1.$(OBJEXT) \
	pcode.$(OBJEXT) \
	token.$(OBJEXT) \
	types.$(OBJEXT) \
	vcc.$(OBJEXT) \
	vcpp/cpp.$(OBJEXT) \
	vcpp/eval.$(OBJEXT) \
	vcpp/hideset.$(OBJEXT) \
	vcpp/include.$(OBJEXT) \
	vcpp/lex.$(OBJEXT) \
	vcpp/macro.$(OBJEXT) \
	vcpp/nlist.$(OBJEXT) \
	vcpp/tokens.$(OBJEXT) \
	vcpp/unix.$(OBJEXT)

all: ../bin/vcc$(EXEEXT)

../bin/vcc$(EXEEXT): $(OBJS)
	$(CXX) -s -o $@ $^ $(LIBS)

%.$(OBJEXT) : %.cpp vcc.h ../../source/progdefs.h ../common/cmdlib.h
	$(CXX) $(CXXFLAGS) -I../common -c -o $@ $<

%.$(OBJEXT) : ../common/%.cpp ../common/cmdlib.h
	$(CXX) $(CXXFLAGS) -c -o $@ $<

vcpp/%.$(OBJEXT) : vcpp/%.cpp vcpp/cpp.h
	$(CXX) $(CXXFLAGS) -c -o $@ $<
