top_srcdir=@top_srcdir@
srcdir=@srcdir@
CXX=@CXX@
CXXFLAGS=@VCC_CXXFLAGS@
CPPFLAGS=@VCC_CPPFLAGS@
EXEEXT=@EXEEXT@
LDFLAGS=@VCC_LDFLAGS@
LIBS=@VCC_LIBS@
OBJEXT=@OBJEXT@

OBJS = \
	cmdlib.$(OBJEXT) \
	constexp.$(OBJEXT) \
	error.$(OBJEXT) \
	expressn.$(OBJEXT) \
	info.$(OBJEXT) \
	modifiers.$(OBJEXT) \
	name.$(OBJEXT) \
	parse.$(OBJEXT) \
	parse1.$(OBJEXT) \
	pcode.$(OBJEXT) \
	stream.$(OBJEXT) \
	token.$(OBJEXT) \
	types.$(OBJEXT) \
	vcc.$(OBJEXT) \
	vcpp/cpp.$(OBJEXT) \
	vcpp/eval.$(OBJEXT) \
	vcpp/hideset.$(OBJEXT) \
	vcpp/include.$(OBJEXT) \
	vcpp/lex.$(OBJEXT) \
	vcpp/macro.$(OBJEXT) \
	vcpp/nlist.$(OBJEXT) \
	vcpp/tokens.$(OBJEXT) \
	vcpp/unix.$(OBJEXT)

all: ../bin/vcc$(EXEEXT)

install:

distdir:

dist:

clean:
	-rm ../bin/vcc$(EXEEXT) *.$(OBJEXT) vcpp/*.$(OBJEXT)

../bin/vcc$(EXEEXT): $(OBJS)
	@mkdir -p ../bin
	$(CXX) -o $@ $^ $(LDFLAGS) $(LIBS)

%.$(OBJEXT) : $(srcdir)/%.cpp $(srcdir)/vcc.h $(top_srcdir)/source/progdefs.h $(srcdir)/../common/cmdlib.h $(srcdir)/../common/array.h
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -I$(srcdir)/../common -c -o $@ $<

%.$(OBJEXT) : $(srcdir)/../common/%.cpp $(srcdir)/../common/cmdlib.h $(srcdir)/../common/array.h
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c -o $@ $<

vcpp/%.$(OBJEXT) : $(srcdir)/vcpp/%.cpp $(srcdir)/vcpp/cpp.h
	@mkdir -p vcpp
	$(CXX) $(CXXFLAGS) -c -o $@ $<
