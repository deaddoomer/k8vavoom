top_srcdir=@top_srcdir@
srcdir=@srcdir@
AR=@AR@
CXX=@CXX@
CXXFLAGS=@GLVIS_CXXFLAGS@
CPPFLAGS=@GLVIS_CPPFLAGS@
EXEEXT=@EXEEXT@
LDFLAGS=@GLVIS_LDFLAGS@
LIBS=@GLVIS_LIBS@
OBJEXT=@OBJEXT@
RANLIB=@RANLIB@

LIB_OBJS = cmdlib.$(OBJEXT) \
	wadlib.$(OBJEXT) \
	level.$(OBJEXT) \
	flow.$(OBJEXT)
OBJS = glvis.$(OBJEXT)

all: ../bin/glvis$(EXEEXT)

../bin/glvis$(EXEEXT): $(OBJS) libglvis.a
	@mkdir -p ../bin
	$(CXX) -o $@ $^ $(LDFLAGS) $(LIBS)

libglvis.a: $(LIB_OBJS)
	$(AR) rc $@ $^
	$(RANLIB) $@

%.$(OBJEXT): $(srcdir)/%.cpp $(srcdir)/*.h $(srcdir)/../common/*.h
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -I$(srcdir)/../common -c -o $@ $<

%.$(OBJEXT): $(srcdir)/../common/%.cpp $(srcdir)/../common/*.h
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c -o $@ $<
